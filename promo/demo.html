<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>csm — Claude Session Manager</title>
<style>
  :root {
    --bg: #1a1b26;
    --fg: #c0caf5;
    --dim: #565f89;
    --cyan: #7dcfff;
    --green: #9ece6a;
    --red: #f7768e;
    --yellow: #e0af68;
    --magenta: #bb9af7;
    --white: #c0caf5;
    --bold: #ffffff;
    --chrome: #24283b;
    --chrome-border: #414868;
    --cursor: #7aa2f7;
  }

  * { margin: 0; padding: 0; box-sizing: border-box; }

  body {
    background: #0f0f1a;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    min-height: 100vh;
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
    overflow: hidden;
  }

  .hero {
    text-align: center;
    margin-bottom: 24px;
    opacity: 0;
    animation: fadeIn 0.8s ease-out 0.3s forwards;
  }

  .hero h1 {
    font-size: 28px;
    color: var(--cyan);
    font-weight: 700;
    letter-spacing: -0.5px;
  }

  .hero h1 span { color: var(--dim); font-weight: 400; }

  .hero p {
    color: var(--dim);
    font-size: 14px;
    margin-top: 6px;
  }

  @keyframes fadeIn {
    from { opacity: 0; transform: translateY(-10px); }
    to   { opacity: 1; transform: translateY(0); }
  }

  .terminal-window {
    width: 920px;
    max-width: 95vw;
    border-radius: 10px;
    overflow: hidden;
    box-shadow: 0 25px 80px rgba(0,0,0,0.6), 0 0 0 1px var(--chrome-border);
    opacity: 0;
    animation: fadeIn 0.8s ease-out 0.5s forwards;
  }

  .title-bar {
    background: var(--chrome);
    padding: 12px 16px;
    display: flex;
    align-items: center;
    gap: 8px;
    border-bottom: 1px solid var(--chrome-border);
  }

  .traffic-light {
    width: 12px; height: 12px; border-radius: 50%;
  }
  .tl-red    { background: #ff5f57; }
  .tl-yellow { background: #febc2e; }
  .tl-green  { background: #28c840; }

  .title-text {
    flex: 1;
    text-align: center;
    color: var(--dim);
    font-size: 13px;
    font-family: 'SF Mono', 'Fira Code', 'Cascadia Code', monospace;
    margin-right: 52px;
  }

  .terminal {
    background: var(--bg);
    padding: 16px 20px;
    font-family: 'SF Mono', 'Fira Code', 'Cascadia Code', 'JetBrains Mono', 'Menlo', monospace;
    font-size: 13px;
    line-height: 1.55;
    color: var(--fg);
    height: 520px;
    overflow: hidden;
    position: relative;
  }

  .terminal-content {
    position: absolute;
    top: 16px; left: 20px; right: 20px;
    transition: transform 0.3s ease;
  }

  .line { white-space: pre; min-height: 1.55em; }
  .prompt-symbol { color: var(--green); }
  .cmd { color: var(--bold); font-weight: 600; }
  .cursor {
    display: inline-block;
    width: 8px; height: 16px;
    background: var(--cursor);
    animation: blink 1s step-end infinite;
    vertical-align: text-bottom;
    margin-left: 1px;
  }
  @keyframes blink {
    50% { opacity: 0; }
  }

  .c-cyan    { color: var(--cyan); }
  .c-green   { color: var(--green); }
  .c-red     { color: var(--red); }
  .c-yellow  { color: var(--yellow); }
  .c-magenta { color: var(--magenta); }
  .c-dim     { color: var(--dim); }
  .c-white   { color: var(--white); }
  .c-bold    { color: var(--bold); font-weight: 600; }
  .c-header  { color: var(--bold); font-weight: 700; }

  .controls {
    display: flex;
    gap: 12px;
    margin-top: 20px;
    opacity: 0;
    animation: fadeIn 0.6s ease-out 0.8s forwards;
  }

  .controls button {
    background: var(--chrome);
    color: var(--fg);
    border: 1px solid var(--chrome-border);
    padding: 8px 20px;
    border-radius: 6px;
    cursor: pointer;
    font-family: inherit;
    font-size: 13px;
    transition: all 0.15s;
  }
  .controls button:hover {
    background: var(--chrome-border);
    border-color: var(--dim);
  }
  .controls button.active {
    background: var(--cursor);
    color: var(--bg);
    border-color: var(--cursor);
  }

  .progress-bar {
    width: 920px;
    max-width: 95vw;
    height: 3px;
    background: var(--chrome);
    border-radius: 2px;
    margin-top: 12px;
    overflow: hidden;
    opacity: 0;
    animation: fadeIn 0.6s ease-out 0.8s forwards;
  }
  .progress-fill {
    height: 100%;
    background: var(--cursor);
    width: 0%;
    transition: width 0.3s linear;
  }

  .badge {
    display: inline-flex;
    align-items: center;
    gap: 6px;
    margin-top: 16px;
    padding: 6px 14px;
    background: var(--chrome);
    border: 1px solid var(--chrome-border);
    border-radius: 20px;
    color: var(--dim);
    font-size: 12px;
    opacity: 0;
    animation: fadeIn 0.6s ease-out 1s forwards;
  }
  .badge code {
    color: var(--cyan);
    font-family: 'SF Mono', 'Fira Code', monospace;
  }
</style>
</head>
<body>

<div class="hero">
  <h1>csm <span>— Claude Session Manager</span></h1>
  <p>Browse, search, and clean up your local Claude Code sessions</p>
</div>

<div class="terminal-window">
  <div class="title-bar">
    <div class="traffic-light tl-red"></div>
    <div class="traffic-light tl-yellow"></div>
    <div class="traffic-light tl-green"></div>
    <div class="title-text">~/projects/my-app — csm</div>
  </div>
  <div class="terminal">
    <div class="terminal-content" id="content"></div>
  </div>
</div>

<div class="progress-bar"><div class="progress-fill" id="progress"></div></div>

<div class="controls">
  <button id="btn-prev">Previous</button>
  <button id="btn-play" class="active">Playing</button>
  <button id="btn-next">Next</button>
</div>

<div class="badge">
  Install: <code>bun install &amp;&amp; bun run setup</code>
</div>

<script>
// ── Scene definitions ────────────────────────────────────────

const SCENES = [
  // Scene 0: csm (default minimal list)
  {
    cmd: "csm",
    delay: 1800,
    output: [
      '<span class="c-cyan c-bold">Claude Session Manager</span>',
      '',
      '<span class="c-dim">Found <span class="c-white">47</span> sessions (1.8 GB total)</span>',
      '',
      '<span class="c-header">ID        Project          Session                                  Date         Msgs</span>',
      '<span class="c-dim">──────────────────────────────────────────────────────────────────────────────────────────</span>',
      'dfde9d19  my-app           Implement user authentication flow        today 14:23    38',
      'a3f1c802  api-server       Fix rate limiting middleware              today 11:05    22',
      '7bc4e91a  dashboard        Add dark mode toggle to settings          yest 16:42     51',
      'e5d82f30  my-app           Refactor database connection pooling      yest 09:18     15',
      '19ca3b77  mobile-app       Expo upgrade from SDK 50 to 51           Wed 20:31      67',
      'b2e6d445  shared-lib       Add TypeScript strict mode               Wed 14:12      29',
      'c81f9a23  api-server       Debug WebSocket reconnection             Tue 10:55      43',
      '44e70dc6  dashboard        Migrate Chart.js to D3 visualizations    3d ago         33',
      'f9b23e11  my-app           Set up CI/CD pipeline with GitHub Act…   5d ago         19',
      '82a1cf56  mobile-app       Implement push notification service      1w ago         56',
      '',
      '<span class="c-dim">47 sessions · 1.8 GB · 2.1M tokens · 89h total</span>',
    ]
  },

  // Scene 1: csm list -v --sort size -n 8
  {
    cmd: "csm list -v --sort size -n 8",
    delay: 2200,
    output: [
      '<span class="c-cyan c-bold">Claude Session Manager</span>',
      '',
      '<span class="c-dim">Found <span class="c-white">47</span> sessions (1.8 GB total)</span>',
      '',
      '<span class="c-header">ID                                    Name      Project       Worktree    Session                 Branch          Date          Dur   Msgs   Tokens     Size</span>',
      '<span class="c-dim">────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────</span>',
      '19ca3b77-d4e1-4f8a-b239-cc71e0f49a12  -         mobile-app    -           Expo upgrade SDK 50→51  feat/expo-51    Wed 20:31    3h     67   312.4K   284.7 MB',
      'dfde9d19-8a23-4bc1-9def-42a1b3c5e789  auth-v2   my-app        -           Implement user auth     feat/auth       today 14:23  1h     38   156.2K   142.3 MB',
      '7bc4e91a-f5d2-4a13-8e67-91b3c4d2f018  -         dashboard     main        Add dark mode toggle    feat/dark-mode  yest 16:42   2h     51   198.7K   128.9 MB',
      'c81f9a23-1b45-4d89-a234-de67f8901bc2  ws-fix    api-server    -           Debug WebSocket recon…  fix/websocket   Tue 10:55    4h     43   245.1K   118.2 MB',
      '82a1cf56-2e89-4f12-b345-ab78cd901234  -         mobile-app    -           Push notification svc   feat/push       1w ago       2h     56   187.3K    98.5 MB',
      '44e70dc6-3f12-4a56-c789-ef01ab234567  d3-viz    dashboard     staging     Migrate Chart.js → D3   feat/d3         3d ago       1h     33   112.8K    87.4 MB',
      'e5d82f30-4a23-4b67-d890-12cd34ef5678  -         my-app        -           Refactor DB connection  refactor/pool   yest 09:18    45m    15    67.4K    54.2 MB',
      'b2e6d445-5b34-4c78-e901-23de45f67890  -         shared-lib    -           Add TS strict mode      feat/strict     Wed 14:12    30m    29    89.1K    43.8 MB',
      '',
      '<span class="c-dim">Showing 8 of 47 sessions</span>',
      '',
      '<span class="c-dim">47 sessions · 1.8 GB · 2.1M tokens · 89h total</span>',
    ]
  },

  // Scene 2: csm find "auth"
  {
    cmd: 'csm find "authentication"',
    delay: 2000,
    output: [
      '<span class="c-cyan c-bold">Searching for:</span> <span class="c-white">authentication</span>',
      '',
      '<span class="c-dim">Found <span class="c-white">4</span> matching session(s)</span>',
      '',
      '  <span class="c-cyan">dfde9d19-8a23-4bc1-9def-42a1b3c5e789</span>  <span class="c-magenta">[auth-v2]</span>  <span class="c-green">Implement user authentication flow</span>',
      '                                      <span class="c-dim">my-app | today 14:23 | 38 msgs | 142.3 MB | 156.2K tokens | feat/auth</span>',
      '                                      <span class="c-dim">Added OAuth2 login, JWT refresh, and session management</span>',
      '',
      '  <span class="c-cyan">901ab234-6c45-4d89-f012-34ef56a78901</span>  <span class="c-green">Fix authentication token expiry bug</span>',
      '                                      <span class="c-dim">api-server | 2w ago | 12 msgs | 23.1 MB | 45.6K tokens | fix/auth-expiry</span>',
      '                                      <span class="c-dim">Fixed race condition in token refresh logic</span>',
      '',
      '  <span class="c-cyan">ab234567-7d56-4e90-0123-45f678b89012</span>  <span class="c-green">Add two-factor authentication support</span>',
      '                                      <span class="c-dim">my-app | 3w ago | 45 msgs | 67.8 MB | 134.2K tokens | feat/2fa</span>',
      '                                      <span class="c-dim">Implemented TOTP-based 2FA with QR code setup flow</span>',
      '',
      '  <span class="c-cyan">cd456789-8e67-4fa1-2345-67a890c01234</span>  <span class="c-green">Research authentication libraries for React</span>',
      '                                      <span class="c-dim">my-app | 1mo ago | 8 msgs | 5.2 MB | 18.9K tokens</span>',
      '                                      <span class="c-dim">Compared NextAuth, Clerk, and Auth0 for the project</span>',
      '',
    ]
  },

  // Scene 3: csm info dfde9d19
  {
    cmd: "csm info dfde9d19",
    delay: 2200,
    output: [
      '',
      '<span class="c-cyan c-bold">Session Details</span>',
      '',
      '  <span class="c-bold">ID              </span> dfde9d19-8a23-4bc1-9def-42a1b3c5e789',
      '  <span class="c-bold">Name            </span> auth-v2',
      '  <span class="c-bold">Label           </span> Implement user authentication flow',
      '  <span class="c-bold">Project         </span> /Users/dev/projects/my-app',
      '  <span class="c-bold">Git Branch      </span> feat/auth',
      '  <span class="c-bold">Created         </span> Feb 22, 2026',
      '  <span class="c-bold">Modified        </span> Feb 22, 2026 (today 14:23)',
      '  <span class="c-bold">Messages        </span> 38',
      '  <span class="c-bold">Total Size      </span> 142.3 MB',
      '  <span class="c-bold">Duration        </span> 1h 12m',
      '  <span class="c-bold">User Messages   </span> 19',
      '  <span class="c-bold">Assistant Msgs  </span> 19',
      '  <span class="c-bold">Input Tokens    </span> 124,891',
      '  <span class="c-bold">Output Tokens   </span> 31,342',
      '  <span class="c-bold">Files Modified  </span> 14',
      '  <span class="c-bold">Lines +/-       </span> <span class="c-green">+716</span> / <span class="c-red">-29</span>',
      '  <span class="c-bold">Git Commits     </span> 5',
      '  <span class="c-bold">Tools Used      </span> Edit(42), Read(38), Bash(12), Write(8), Grep(6)',
      '  <span class="c-bold">Languages       </span> TypeScript(48), SQL(6), JSON(4)',
      '  <span class="c-bold">Features        </span> Task Agent, Web Search',
      '  <span class="c-bold">Brief Summary   </span> Added OAuth2 login, JWT refresh, and session management',
      '  <span class="c-bold">Outcome         </span> fully_completed',
      '  <span class="c-bold">Helpfulness     </span> very_helpful',
      '',
    ]
  },

  // Scene 4: csm stats
  {
    cmd: "csm stats",
    delay: 2000,
    output: [
      '<span class="c-cyan c-bold">Session Statistics</span>',
      '',
      '<span class="c-bold">Overall</span>',
      '  Sessions:   47',
      '  Total size: 1.8 GB  (avg 38.3 MB)',
      '  Tokens:     2.1M',
      '  Duration:   89h 24m',
      '',
      '<span class="c-bold">By project</span>',
      '<span class="c-header">Group                     Sessions       Size     Tokens   Duration</span>',
      '<span class="c-dim">────────────────────────────────────────────────────────────────────────</span>',
      'my-app                          14    612.4 MB     782.1K   32h 15m',
      'api-server                       9    389.2 MB     412.8K   21h 40m',
      'dashboard                        8    301.5 MB     356.2K   15h 30m',
      'mobile-app                       7    445.1 MB     389.4K   12h 45m',
      'shared-lib                       5     43.8 MB      89.1K    4h 20m',
      'docs-site                        4     12.0 MB      71.4K    3h  4m',
      '',
    ]
  },

  // Scene 5: csm clean --dry-run --older-than 30
  {
    cmd: "csm clean --dry-run --older-than 30",
    delay: 2200,
    output: [
      '<span class="c-cyan c-bold">Claude Session Cleaner</span>',
      '',
      '<span class="c-yellow">[DRY RUN]</span> Would show interactive selection for 47 sessions:',
      '',
      '<span class="c-header">Project               Session                                     Date        Size</span>',
      '<span class="c-dim">──────────────────────────────────────────────────────────────────────────────────────</span>',
      'my-app                Research authentication libraries            1mo ago     5.2 MB',
      'docs-site             Update API documentation for v2              1mo ago     3.1 MB',
      'api-server            Initial project scaffolding                  2mo ago     8.7 MB',
      'shared-lib            Experiment with Bun test runner              2mo ago     2.4 MB',
      'dashboard             Fix responsive layout on mobile              2mo ago    12.3 MB',
      'my-app                Debug memory leak in SSR                     3mo ago    45.6 MB',
      'mobile-app            Set up Detox E2E testing                     3mo ago    18.9 MB',
      'api-server            Implement rate limiting research             4mo ago     6.2 MB',
      '',
      '<span class="c-dim">Would pre-select 8 sessions older than 30 days (102.4 MB)</span>',
    ]
  },

  // Scene 6: csm help (abbreviated)
  {
    cmd: "csm help",
    delay: 2400,
    output: [
      '',
      '<span class="c-cyan c-bold">csm</span> - Claude Session Manager',
      '',
      '<span class="c-bold">USAGE</span>',
      '  csm [command] [options]',
      '',
      '<span class="c-bold">COMMANDS</span>',
      '  <span class="c-green">list</span>, <span class="c-green">l</span>              List all sessions (default)',
      '  <span class="c-green">find</span>, <span class="c-green">f</span> &lt;query&gt;       Search sessions by description',
      '  <span class="c-green">info</span>, <span class="c-green">i</span> &lt;session-id&gt;  Show detailed session information',
      '  <span class="c-green">clean</span>, <span class="c-green">c</span>             Interactively select and remove sessions',
      '  <span class="c-green">browse</span>, <span class="c-green">b</span>            Interactive session browser',
      '  <span class="c-green">export</span> &lt;id&gt; &lt;dir&gt;     Export a session to a directory',
      '  <span class="c-green">backup</span> &lt;dir&gt;          Bulk export old sessions',
      '  <span class="c-green">stats</span>                 Aggregate statistics',
      '  <span class="c-green">help</span>                  Show this help message',
      '',
      '<span class="c-bold">EXAMPLES</span>',
      '  csm                                List all sessions',
      '  csm l -v --sort size               Verbose table sorted by size',
      '  csm f "expo upgrade"               Search sessions',
      '  csm i dfde9d19                     Show session details',
      '  csm c --older-than 30              Clean old sessions',
      '  csm stats --by language            Stats by language',
      '',
      '<span class="c-bold">SETUP</span>',
      '  bun run setup                      Install \'csm\' globally',
      '',
    ]
  },
];

// ── Terminal replay engine ────────────────────────────────────

const contentEl = document.getElementById('content');
const progressEl = document.getElementById('progress');
const btnPlay = document.getElementById('btn-play');
const btnPrev = document.getElementById('btn-prev');
const btnNext = document.getElementById('btn-next');

let currentScene = -1;
let isPlaying = true;
let typeTimer = null;
let sceneTimer = null;

function clearTimers() {
  if (typeTimer) { clearTimeout(typeTimer); typeTimer = null; }
  if (sceneTimer) { clearTimeout(sceneTimer); sceneTimer = null; }
}

function renderPrompt() {
  return '<span class="prompt-symbol">❯</span> ';
}

function typeCommand(cmd, callback) {
  contentEl.innerHTML = '';
  const promptLine = document.createElement('div');
  promptLine.className = 'line';
  promptLine.innerHTML = renderPrompt();
  contentEl.appendChild(promptLine);

  let i = 0;
  const cursorSpan = document.createElement('span');
  cursorSpan.className = 'cursor';
  promptLine.appendChild(cursorSpan);

  function typeChar() {
    if (i < cmd.length) {
      // Insert char before cursor
      const charSpan = document.createElement('span');
      charSpan.className = 'cmd';
      charSpan.textContent = cmd[i];
      promptLine.insertBefore(charSpan, cursorSpan);
      i++;
      const delay = 30 + Math.random() * 50;
      typeTimer = setTimeout(typeChar, delay);
    } else {
      // Done typing, brief pause then "execute"
      typeTimer = setTimeout(() => {
        cursorSpan.remove();
        callback();
      }, 400);
    }
  }
  typeChar();
}

function showOutput(lines, callback) {
  // Small delay to simulate execution
  typeTimer = setTimeout(() => {
    // Re-render with full prompt + output
    const scene = SCENES[currentScene];
    let html = '<div class="line">' + renderPrompt() + '<span class="cmd">' + escapeHtml(scene.cmd) + '</span></div>';

    for (const line of lines) {
      html += '<div class="line">' + line + '</div>';
    }

    // Add empty prompt at the bottom
    html += '<div class="line">' + renderPrompt() + '<span class="cursor"></span></div>';

    contentEl.innerHTML = html;

    // Scroll to show content if needed
    const contentHeight = contentEl.scrollHeight;
    const termHeight = 520;
    if (contentHeight > termHeight - 32) {
      const offset = Math.min(0, termHeight - 32 - contentHeight);
      contentEl.style.transform = `translateY(${offset}px)`;
    } else {
      contentEl.style.transform = 'translateY(0)';
    }

    if (callback) callback();
  }, 300);
}

function escapeHtml(str) {
  return str.replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/>/g, '&gt;');
}

function updateProgress() {
  const pct = ((currentScene + 1) / SCENES.length) * 100;
  progressEl.style.width = pct + '%';
}

function playScene(index) {
  clearTimers();
  currentScene = index;
  if (currentScene >= SCENES.length) currentScene = 0;
  if (currentScene < 0) currentScene = SCENES.length - 1;

  updateProgress();

  const scene = SCENES[currentScene];

  typeCommand(scene.cmd, () => {
    showOutput(scene.output, () => {
      if (isPlaying) {
        sceneTimer = setTimeout(() => {
          playScene(currentScene + 1);
        }, scene.delay + 1500);
      }
    });
  });
}

function togglePlay() {
  isPlaying = !isPlaying;
  btnPlay.textContent = isPlaying ? 'Playing' : 'Paused';
  btnPlay.classList.toggle('active', isPlaying);

  if (isPlaying) {
    sceneTimer = setTimeout(() => {
      playScene(currentScene + 1);
    }, 1500);
  } else {
    clearTimers();
  }
}

btnPlay.addEventListener('click', togglePlay);

btnNext.addEventListener('click', () => {
  isPlaying = false;
  btnPlay.textContent = 'Paused';
  btnPlay.classList.remove('active');
  playScene(currentScene + 1);
});

btnPrev.addEventListener('click', () => {
  isPlaying = false;
  btnPlay.textContent = 'Paused';
  btnPlay.classList.remove('active');
  playScene(currentScene - 1);
});

// Keyboard controls
document.addEventListener('keydown', (e) => {
  if (e.key === ' ' || e.key === 'k') {
    e.preventDefault();
    togglePlay();
  } else if (e.key === 'ArrowRight' || e.key === 'l') {
    isPlaying = false;
    btnPlay.textContent = 'Paused';
    btnPlay.classList.remove('active');
    playScene(currentScene + 1);
  } else if (e.key === 'ArrowLeft' || e.key === 'h') {
    isPlaying = false;
    btnPlay.textContent = 'Paused';
    btnPlay.classList.remove('active');
    playScene(currentScene - 1);
  }
});

// Start the demo after a brief delay
setTimeout(() => playScene(0), 1200);
</script>
</body>
</html>
